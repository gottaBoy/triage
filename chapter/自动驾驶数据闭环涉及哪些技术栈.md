作者：李众力
链接：https://www.zhihu.com/question/581571930/answer/1975546392517812248
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

前言：先说结论，自动驾驶数据闭环是一个非常工程化的体系，里面有各种算法但本质上是对某些环节进行提速，但是如果没有很好的全局视角，那其实根本无法闭环。据我能接触到的一圈国内玩家，大家嘴里的“数据闭环”，绝大多数还是各个算法团队内部的“小闭环”。离当年 PPT 里畅想的那种“数据直接自动解决问题”的大闭环，还有好几层台阶。先简单自报家门（方便大家判断我是不是在瞎说）： 我从事自动驾驶行业大概 7 年多了，从最早那种“开完车工程师拎着硬盘，从工控机上拔下来去机房拷数据”的年代一路干到现在。这几年主要在一家互联网大厂的物流无人车项目里，负责整车的数据体系和质量体系搭建。日常工作基本就是跟各种 Log、Trigger、标注平台、仿真平台、QA 流程和一堆诡异 Bug 打交道。下面所有观点，都是站在这个“数据闭环 + 质量体系”视角下的个人实战经验。一、先对齐一下：什么叫“真的数据闭环”？我心目中“真闭环”，至少要满足三层：问题发现自动化 不是靠“司机吐槽 + 群里截图 + 领导试驾骂了一句”触发，而是系统能从海量运行数据里自动发现异常行为（急刹、蛇形、异常接管、安全边缘场景）。问题到方案的路径是“可重复、可量化”的 一个线上问题 →\rightarrow\rightarrow 自动归类 →\rightarrow\rightarrow 自动进训练/仿真 →\rightarrow\rightarrow 产出候选方案 →\rightarrow\rightarrow 自动评估。人主要做的是定义目标和拍板，而不是从 0 到 1 手工搬砖。解决效果可量化、可复盘 新版本上线后，系统要能回答：发生频率有没有下去？有没有引入新问题？这次投入值不值？一句话概括：真正的数据闭环，是“问题会自己长脚走完从『被发现』到『被解决并被验证』的路径”。二、现实里大多数厂商在做什么？比较诚实的说法：今天很多所谓“数据闭环”，其实是“数据驱动的研发流程 + 一些自动化工具”，而且大多局限在单个算法团队的小视角。典型的“伪”闭环流水线：被动触发： 靠人工或简单的 Trigger 捞“疑似有问题”的包。各自为战： 感知、规控、地图团队各玩各的小闭环，出了问题互相甩锅（“感知没漏，是你规控刹猛了”）。链路断裂： 数据变成了模型，但没人回答“解决了哪个线上真实问题”。自愈有限： 所谓的“自动平台”更像是一个高度自动化的工厂生产线，而不是一个可以自我决策的“自愈系统”。三、我的数据闭环实践：一套 Bug-Driven 的工程体系不敢说“完美闭环”，但我们是真把“数据当产品、指标当客户”来设计的。我把这套实践总结为六个关键步骤，对应我写过的六篇实战文章。1. 选对 Loss Function：从 MPI 到 MPS/MPD（对应实战篇 01）把整个自动驾驶组织看作一个强化学习模型，一级指标就是它的 Loss Function。放弃 MPI (Miles Per Intervention)： 它优化的是“人多久救一次场”，而不是“车开得好不好”。拥抱 MPS (Miles Per Stupid)： 每万公里急刹、画龙、停车不走。这是体验罚项。拥抱 MPD (Miles Per Dangerous)： 每万公里险情、事故。这是安全底线。我们不再问“人什么时候接管”，而是问“车在真实世界里干了多少蠢事”。2. 数据地基：1Hz 心跳与分级上传（对应实战篇 02 & 03）面对一分钟 4GB 的原始数据，不可能全传。我们做了一套分级体系：业务心跳 (1Hz)： 上报里程、状态、场景，做 BI 和实时大盘。Microlog (黑匣子)： 高频姿态 + 底盘 + 控制指令，极低带宽，用于计算 MPS 体感指标。Minilog (场景重建包)： 抽稀的轨迹 + 压缩视频 + 关键中间结果，让人和仿真能看懂场景，但不传原始点云。Raw Data (按需)： 只有被 Trigger 命中或 MPD 事件，才上传原始传感器数据。并且，我们建立了 Road Case (场景母体) 与 Bad Case (模块子问题) 的逻辑映射，让每一次上传都能算清“是为了哪个 Bug 买单”。3. 云端标签中枢：秒级特征空间（对应实战篇 04）为了让数据能被“挖”出来，我们建立了一套每车每秒的标签体系。FreeDM →\rightarrow\rightarrow FastDM： 我们把车辆运行的每一秒都打上数百个标签（天气、路型、拥堵度、是否急刹）。交互式挖掘： 以前挖数据写 SQL 要半小时，现在通过 ADB 宽表加速，产品经理也能在 1 分钟内筛出“雨天 + 园区 + 急刹”的所有 Case。4. 三端统一 Trigger：让问题自动“长”出来（对应实战篇 05）这是数据闭环的“中枢神经”。代码级统一： 车端实时监控、云端历史挖掘、仿真评测，用的是同一套 Python Trigger 代码。避免了“车上报了警，云端回测却没问题”的扯皮。Python + LLM： 我们把 Trigger 封装成简单的 Python 接口，并利用 LLM 辅助生成规则，让非算法同学（测试、运营）也能写规则抓 Bug。5. 智能分发：LLM 做分类器，工单自动闭环（对应实战篇 05）问题发现了，谁来修？Trigger = Tokenizer： 把原始时序数据切分成一个个有语义的 Token（如“障碍物尺寸跳变”、“预测轨迹震荡”）。LLM = Classifier： 大模型读取 Token 序列和场景标签，生成“事件脚本”，自动判断这是“感知误检”还是“规控保守”，并自动路由给对应团队。自动闭环： 自动提单 →\rightarrow\rightarrow 自动加入仿真回归集 →\rightarrow\rightarrow 新版本自动跑回归。6. 典型场景闭环：从“乱挖”到“治病”（对应实战篇 06）最后，我们将零散的 Case 聚类成**“典型问题场景”**（如：红色消防栓被误检为小孩）。主动挖数： 基于场景 Profile，定向去挖数据的“长尾”。生成式补短板： 利用 Minilog 重建稀缺场景，在仿真里泛化（比如生成各种光照下的消防栓），而不是凭空造假数据。实车灰度： 仿真不是终点。我们依赖 10% 灰度车队的实车数据，看 MPS/MPD 指标在特定场景下是否真的下降，作为最终的“疗效验证”。四、一点冷思考：从 Data-Driven 到 Bug-Driven写了这么多，如果让我给现在这套东西起一个更诚实的名字，我反而会叫它：Bug-Driven 开发体系。听上去一点也不“高大上”，但这几年实践下来，真正在一线推动车辆迭代往前走的，往往就是一个个具体的 Bug：某个路口左转犹豫、某段路鬼畜急刹、某种光照下漏检。我们搭建的所有数据体系，本质上就是：更快、更准、更系统地发现这些 Bug，量化这些 Bug，跟踪这些 Bug 的出现与消失。好消息是，随着端到端模型 (E2E) 和 世界模型 的兴起，未来的闭环可能会更加优雅：端到端 让“真值”更接近人类驾驶行为，绕开了很多中间模块的纠结。世界模型 可能会真正打通“仿真”与“真实”的最后一公里，让验证不再那么痛苦。但在那之前，作为工程师，我们能做的最扎实的工作，就是把这套“发现 →\rightarrow\rightarrow 定义 →\rightarrow\rightarrow 解决 →\rightarrow\rightarrow 验证”的下水道工程修得再通畅一点。毕竟，没有数据闭环，大家只会觉得 PPT 难画；有了数据闭环，大家才会觉得“这车怎么越开越像个老司机”。附：系列文章索引如果你对具体的工程实现感兴趣，可以点击下方链接深入阅读每一篇实战细节：[01] 目标设定： 最重要的第一步：选对整个组织的 Loss Function (MPI vs MPS/MPD)[02] 数据基础： L4 无人车的实时打点与业务心跳[03] 上传机制： 数据分级上传与 Case/File 逻辑映射设计[04] 云端挖掘： 从 FreeDM 到 FastDM 的秒级标签特征空间[05] 问题发现： 三端统一 Trigger 框架：让异常事件自动“长成”问题单[06] 闭环验证： 典型问题场景闭环：从聚类到主动挖数与多层验证